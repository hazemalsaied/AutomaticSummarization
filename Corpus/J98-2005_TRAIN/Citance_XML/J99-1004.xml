<PAPER>
	<ABSTRACT>
		<S sid ="1" ssid = "1">We prove a number of useful results about probabilistic context-free grammars (PCFGs) and their Gibbs representations.</S>
		<S sid ="2" ssid = "2">Wepresent a method, called the relative weighted frequency method, to assign production probabilities that impose pro per PCFG distributions on finite parses.</S>
		<S sid ="3" ssid = "3">We demonstrate that these distributions have finite entropies.</S>
		<S sid ="4" ssid = "4">In addition, under the distributions, sizes of parses havefinite moment of any order.</S>
		<S sid ="5" ssid = "5">Weshow that Gibbs distributions on CFG parses, which generalize PCFG distributions and are more powerful, become PCFG distributions if their features only include frequencies of production rules in parses.</S>
		<S sid ="6" ssid = "6">Under these circumstances, we prove the equivalence of the maximum-likelihood (ML) estimation procedures for these two types of probabilit y distributions on parses.</S>
		<S sid ="7" ssid = "7">We introduce the renormalization of improper PCFGs to pro per ones.</S>
		<S sid ="8" ssid = "8">We also stud y PCFGs from the pers pective of stochastic branching processes.</S>
		<S sid ="9" ssid = "9">We prove that with their production probabilities assigned by the relative weighted frequency method, PCFGs are subcritical, i.e., their branching rates are less than one.</S>
		<S sid ="10" ssid = "10">We also show that by renormalization, connected supercritical PCFGs become subcritical ones.</S>
		<S sid ="11" ssid = "11">Finall y, some minor issues, including identifiabilit y and approximation of production probabilities of PCFGs, are discussed.</S>
	</ABSTRACT>
	<SECTION title="Introduction" number = "1">
			<S sid ="12" ssid = "12">This article proves a number of useful properties of probabilistic context-free grammars (PCFGs).</S>
			<S sid ="13" ssid = "13">In this section, we give an introduction to the results and related topics.</S>
			<S sid ="14" ssid = "14">1.1 Assignment of Proper PCFG Distributions.</S>
			<S sid ="15" ssid = "15">Finite parse trees, or parses, generated by a context-free grammar (CFG) can be equipped with a variety of probability distributions.</S>
			<S sid ="16" ssid = "16">The simplest way to do this is by production probabilities.</S>
			<S sid ="17" ssid = "17">First, for each nonterminal symbol in the CFG, a probability distribution is placed on the set of all productions from that symbol.</S>
			<S sid ="18" ssid = "18">Then each finite parse tree is allocated a probability equal to the product of the probabilities of all productions in the tree.</S>
			<S sid ="19" ssid = "19">More specifically, denote a finite parse tree by T . For any production rule A ----+ a of the CFG, letf (A ----+ a;T) be the number of times it occurs in T. Let R be the set of all production rules.</S>
			<S sid ="20" ssid = "20">Then p(T ) = II p( A ----+ a) f ( A-+a;r ) .</S>
			<S sid ="21" ssid = "21">(A-+a)ER A CFG with a probability distribution on its parses assigned in this way is called a probabilistic context-free grammar (PCFG) (Booth and Thompson 1973; Grenander * Department of Statistics, University of Chicago, Chicago, IL 60637, USA.</S>
			<S sid ="22" ssid = "22">Email: chi@galton.uchicago.edu.</S>
			<S sid ="23" ssid = "23">This work was supported by the Army Research Office (DAAL0392-G-0115), the National Science Foundation (DMS9217655), and the Office of Naval Research (N0001496-10647).</S>
			<S sid ="24" ssid = "24">© 1999 Association for Computational Linguistics 1976)1 and the probability distribution is called a PCFG distribution.</S>
			<S sid ="25" ssid = "25">A PCFG may be improper, i.e., the total probability of parses may be less than one.</S>
			<S sid ="26" ssid = "26">For instance, consider the CFG in Chomsky normal form: 5 -+ 55 5 -+ a (1) where 5 is the only nonterminal symbol, and a is the only terminal symbol.</S>
			<S sid ="27" ssid = "27">If p(5 -+ 55) = p, then p(5 -+ a ) = 1-p.</S>
			<S sid ="28" ssid = "28">Let xh be the total probability of all parses with height no larger than h. Clearly, xh is increasing.</S>
			<S sid ="29" ssid = "29">It is not hard to see that xh+l = 1- p + px . Therefore, the limit of xh, which is the total probability of all parses, is a solution for the equation x = 1 - p + px 2 • The equation has two solutions: 1 and 1/p - 1.</S>
			<S sid ="30" ssid = "30">It can be shown that x is the smaller of the two: x = min(l, 1/p - 1).</S>
			<S sid ="31" ssid = "31">Therefore, if p &gt; 1/2, x &lt; 1-an improper probability.</S>
			<S sid ="32" ssid = "32">How to assign proper production probabilities is quite a subtle problem.</S>
			<S sid ="33" ssid = "33">A suffi­ cient condition for proper assignment is established by Chi and Geman (1998), who prove that production probabilities estimated by the maximum-likelihood (ML) esti­ mation procedure (or relative frequency estimation procedure, as it is called in com­ putational linguistics) always impose proper PCFG distributions.</S>
			<S sid ="34" ssid = "34">Without much diffi­ culty, this result can be generalized to a simple procedure, called &quot;the relative weighted frequency&quot; method, which assigns proper production probabilities of PCFGs.</S>
			<S sid ="35" ssid = "35">We will give more details of the generalization in Section 3 and summarize the method in Proposition 1.</S>
			<S sid ="36" ssid = "36">1.2 Entropy and Moments of Parse Tree Sizes.</S>
			<S sid ="37" ssid = "37">As a probabilistic model for languages, the PCFG model has several important statis­ tical properties, among which is the entropy of PCFG distribution on parses.</S>
			<S sid ="38" ssid = "38">Entropy is a measure of the uncertainty of a probability distribution.</S>
			<S sid ="39" ssid = "39">The larger its entropy, the less one can learn about parses randomly sampled from the distribution.</S>
			<S sid ="40" ssid = "40">As an example, suppose we have a set 5 of N parses--or any objects-T1, . . .</S>
			<S sid ="41" ssid = "41">, TN, where N is very large.</S>
			<S sid ="42" ssid = "42">We may ask how much one can learn from the sentence &quot;T is a random sample from 5.&quot;</S>
			<S sid ="43" ssid = "43">At one extreme, let the distribution on 5 be p( T1) = 1, and p( Ti) = 0, for i =I- 1.</S>
			<S sid ="44" ssid = "44">Then, because with probability one, T = T1,there is no uncertainty about the sample.</S>
			<S sid ="45" ssid = "45">In other words, we can get full information from the above sentence.</S>
			<S sid ="46" ssid = "46">At the other extreme, suppose the distribution is p( T1) = . . .</S>
			<S sid ="47" ssid = "47">= p( TN) = 1/N. In this case, all the elements of 5 are statistically equivalent.</S>
			<S sid ="48" ssid = "48">No specific information is given about T that would make it possible to know it from 5.</S>
			<S sid ="49" ssid = "49">Greater effort is required-for example, enumerating all the elements in 5-to find what T is. Since 5 is big, the uncertainty about the sample is then much greater.</S>
			<S sid ="50" ssid = "50">Correspondingly, for the two cases, the entropy is O and N log N »0, respectively.</S>
			<S sid ="51" ssid = "51">Entropy plays a central role in the theory of information.</S>
			<S sid ="52" ssid = "52">For an excellent exposi­ tion of this theory, we refer the reader to Cover and Thomas (1991).</S>
			<S sid ="53" ssid = "53">The theory has been applied in probabilistic language modeling (Mark, Miller, and Grenander 1996; Mark et al. 1996; Johnson 1998), natural language processing (Berger, Della Pietra, and Della Pietra 1996; Della Pietra, Della Pietra, and Lafferty 1997), as well as computational vision (Zhu, Wu, and Mumford 1997).</S>
			<S sid ="54" ssid = "54">In addition, all the models proposed in these articles are based on an important principle called the maximum entropy principle.</S>
			<S sid ="55" ssid = "55">Chapter 11 of Cover and Thomas (1991) gives an introduction to this principle.</S>
			<S sid ="56" ssid = "56">1A probabilistic context-free grammar is also called a stochastic context-free grammar (SCFG) Briefly, the maximum entropy principle says that among all the distributions that satisfy the same given conditions, the one that achieves the largest entropy should be the model of choice.</S>
			<S sid ="57" ssid = "57">For a distribution p on parses, its entropy is In order that the maximum entropy principle makes sense, all the candidate distribu­ tions should have finite entropies, and this is usually implicitly assumed.</S>
			<S sid ="58" ssid = "58">Take Mark, Miller, and Grenander&apos;s (1996) model, for example.</S>
			<S sid ="59" ssid = "59">First, a PCFG distribution p is selected to serve as a &quot;reference&quot; distribution on parses.</S>
			<S sid ="60" ssid = "60">Then, by invoking the minimum relative entropy principle, which is a variant of the maximum entropy principle, the distribution that minimizes D(q ll p) = L q(T) log ; = L q(T) log p() - H(q) T T subject to a set of constraints incorporating context-sensitive features is chosen to be the distribution of the model.</S>
			<S sid ="61" ssid = "61">It is then easy to see that the assumption that H(q) is finite is necessary.</S>
			<S sid ="62" ssid = "62">Conceptually, having finite entropy is a basic requirement for a &quot;good&quot; proba­ bilistic model because a probability distribution with infinite entropy has too much uncertainty to be informative.</S>
			<S sid ="63" ssid = "63">Problems regarding entropies of PCFGs are relatively easy to tackle because they can be studied analytically.</S>
			<S sid ="64" ssid = "64">Several authors have reported results on this subject, in­ cluding Miller and O&apos;Sullivan (1992), who gave analytical results on the rates of en­ tropies of improper PCFGs.</S>
			<S sid ="65" ssid = "65">It is worthwhile to add a few more results on entropies of proper PCFGs.</S>
			<S sid ="66" ssid = "66">In this paper, we show that the entropies of PCFG distributions im­ posed by production probabilities assigned by the relative weighted frequency method are finite (Section 4, Corollary 2).</S>
			<S sid ="67" ssid = "67">In addition to entropy, we will also study the moment of sizes of parses.</S>
			<S sid ="68" ssid = "68">The mo­ ment is of statistical interest because it gives information on how sizes of parses are distributed.</S>
			<S sid ="69" ssid = "69">For PCFG distributions, the first moment of sizes of parses, i.e., the mean size of parses, is directly linked with the entropy: the mean size of parses is finite if and only if the entropy is. The second moment of sizes is another familiar quantity.</S>
			<S sid ="70" ssid = "70">The difference between the second moment and the mean squared is the variance of sizes, which tells us how &quot;scattered&quot; sizes of parses are distributed around the mean.</S>
			<S sid ="71" ssid = "71">Proposition 2 shows that, under distributions imposed by production probabilities as­ signed by the relative weighted frequency method, sizes of parses have finite moment of any order.</S>
			<S sid ="72" ssid = "72">1.3 Gibbs Distributions on Parses and Renormalization of Improper PCFGs.</S>
			<S sid ="73" ssid = "73">Besides PCFG distributions, a CFG can be equipped with many other types of proba­ bility distributions.</S>
			<S sid ="74" ssid = "74">Among the most widely studied is the Gibbs distribution (Mark, Miller, and Grenander 1996; Mark et al. 1996; Mark 1997; Abney 1997).</S>
			<S sid ="75" ssid = "75">Gibbs distribu­ tions arise naturally by invoking the maximum entropy principle.</S>
			<S sid ="76" ssid = "76">They are considered to be more powerful than PCFG distributions because they incorporate more features, especially context-sensitive features, of natural languages, whereas PCFG distributions only consider frequencies of production rules.</S>
			<S sid ="77" ssid = "77">On the other hand, Gibbs distributions are not always superior to PCFG distributions.</S>
			<S sid ="78" ssid = "78">A Gibbs distribution, with only fre­ quencies of production rules in parse as its features, turns into a PCFG.</S>
			<S sid ="79" ssid = "79">More specif­ ically, we will show in Proposition 4 in Section 5, that a CFG equipped with a Gibbs distribution of the form (2) is actually a PCFG, and we can get the production probabilities of the PCFG explicitly from the Gibbs form.</S>
			<S sid ="80" ssid = "80">The fact that a Gibbs distribution of the form in (2) is imposed by production probabilities has a useful consequence.</S>
			<S sid ="81" ssid = "81">Suppose p is an improper PCFG distribution.</S>
			<S sid ="82" ssid = "82">If we write the sum of p over all parses as Z, and assign to each parse tree a new probability equal to p(T ) / Z, then we renormalize p to a Gibbs distribution p on parses.</S>
			<S sid ="83" ssid = "83">What (2) implies is that p is also a PCFG distribution (Corollary 3).</S>
			<S sid ="84" ssid = "84">Moreover, in Section 6 we will show that, under certain conditions, p is subcritical.</S>
			<S sid ="85" ssid = "85">There is another issue about the relations between PCFG distributions and Gibbs distributions of the form in (2), from a statistical point of view.</S>
			<S sid ="86" ssid = "86">Although PCFG dis­ tributions are special cases of Gibbs distributions in the sense that the former can be written in the form of the latter, PCFG distributions cannot be put in the framework of Gibbs distributions if they have different parameter estimation procedures.</S>
			<S sid ="87" ssid = "87">We will compare the maximum-likelihood (ML) estimation procedures for these two distribu­ tions.</S>
			<S sid ="88" ssid = "88">As will be seen in Section 5, numerically these two estimation procedures are different.</S>
			<S sid ="89" ssid = "89">However, Corollary 4 shows that they are equivalent in the sense that esti­ mates by the two procedures impose the same distributions on parses.</S>
			<S sid ="90" ssid = "90">For this reason, a Gibbs distribution may be considered a generalization of PCFG, not only in form, but also in a certain statistical sense.</S>
			<S sid ="91" ssid = "91">1.4 Branching Rates of PCFGs.</S>
			<S sid ="92" ssid = "92">Because of their context-free nature, PCFG distributions can also be studied from the perspective of stochastic processes.</S>
			<S sid ="93" ssid = "93">A PCFG can be described by a random branch­ ing process (Harris 1963), and its asymptotic behavior can be characterized by its branching rate.</S>
			<S sid ="94" ssid = "94">A branching process, or its corresponding PCFG, is called subcritical (critical, supercritical), if its branching rate &lt; 1(= 1, &gt; 1).</S>
			<S sid ="95" ssid = "95">A subcritical PCFG is always proper, whereas a supercritical PCFG is always improper.</S>
			<S sid ="96" ssid = "96">Many asymptotic properties of supercritical branching processes are established by Miller and O&apos;Sullivan (1992).</S>
			<S sid ="97" ssid = "97">Chi and Geman (1998) proved the properness of PCFG distributions imposed by esti­ mated production probabilities, and around the same time Sanchez and Benedi (1997) established the subcriticality of the corresponding branching processes, hence their properness.</S>
			<S sid ="98" ssid = "98">In this paper we will explore properties of branching rate further.</S>
			<S sid ="99" ssid = "99">First, in Proposition 5, we will show that if a PCFG distribution is imposed by production probabilities assigned by the relative weighted frequency method, then the PCFG is subcritical.</S>
			<S sid ="100" ssid = "100">The result generalizes that of Sanchez and Benedi (1997), and has a less involved proof.</S>
			<S sid ="101" ssid = "101">Then in Proposition 7, we will demonstrate that a connected and improper PCFG, after being renormalized, becomes a subcritical PCFG.</S>
			<S sid ="102" ssid = "102">1.5 Identifiability and Approximation of Production Probabilities.</S>
			<S sid ="103" ssid = "103">Returning to the statistical aspect of PCFGs, we will discuss the identifiability of pro­ duction probabilities of PCFGs as well as parameters of Gibbs distributions.</S>
			<S sid ="104" ssid = "104">Briefly speaking, production probabilities of PCFGs are identifiable, which means that differ­ ent production probabilities always impose different distributions on parses (Proposi­ tion 8).</S>
			<S sid ="105" ssid = "105">In contrast, for the Gibbs distribution given by (2), the &gt;, parameters are not identifiable; in fact, there are infinitely many different &gt;.</S>
			<S sid ="106" ssid = "106">that impose the same Gibbs distribution.</S>
			<S sid ="107" ssid = "107">Finally, in Proposition 9, we propose a method to approximate production prob­ abilities.</S>
			<S sid ="108" ssid = "108">Perhaps the most interesting part about the result lies in its proof, which is largely information theoretic.</S>
			<S sid ="109" ssid = "109">We apply the KullbackLeibler divergence, which is the information distance between two probability distributions, to prove the convergence of the approximation.</S>
			<S sid ="110" ssid = "110">Ininformation theory literature, the KullbackLeibler divergence is also called the relative entropy.</S>
			<S sid ="111" ssid = "111">We also use Lagrange multipliers to solve the con­ strained minimization problem involved.</S>
			<S sid ="112" ssid = "112">Both KullbackLeibler divergence and La­ grange multipliers method are becoming increasingly useful in statistical modeling, e.g., modeling based on the maximum entropy principle.</S>
			<S sid ="113" ssid = "113">1.6 Summary.</S>
			<S sid ="114" ssid = "114">As a simple probabilistic model, the PCFG model is applied to problems in linguistics and pattern recognition that do not involve much context sensitivity.</S>
			<S sid ="115" ssid = "115">To design sensi­ ble PCFG distributions for such problems, it is necessary to understand some of the statistical properties of the distributions.</S>
			<S sid ="116" ssid = "116">On the other hand, the PCFG model serves as a basis for more expressive linguistic models.</S>
			<S sid ="117" ssid = "117">For example, many Gibbs distributions are built upon PCFG distributions by defining p(T )e&gt;-.·U( r ) P(T) = z I where p is a PCFG distribution.</S>
			<S sid ="118" ssid = "118">Therefore, in order for the Gibbs distribution P to have certain desired statistical properties, it is necessary for p to have those properties first.</S>
			<S sid ="119" ssid = "119">This paper concerns some of the fundamental properties of PCFGs.</S>
			<S sid ="120" ssid = "120">However, the methods used in the proofs are also useful for the study of statistical issues on other probabilistic models.</S>
			<S sid ="121" ssid = "121">This paper proceeds as follows: In Section 2, we gather the notations for PCFGs that will be used in the remaining part of the paper.</S>
			<S sid ="122" ssid = "122">Section 3 establishes the rel­ ative weighted frequency method.</S>
			<S sid ="123" ssid = "123">Section 4 proves the finiteness of the entropies of PCFG distributions when production probabilities are assigned using the relative weighted frequency method.</S>
			<S sid ="124" ssid = "124">In addition, finiteness of the moment of sizes of parses are proved.</S>
			<S sid ="125" ssid = "125">Section 5 discusses the connections between PCFG distributions and Gibbs distributions on parses.</S>
			<S sid ="126" ssid = "126">Renormalization of improper PCFGs is also discussed here.</S>
			<S sid ="127" ssid = "127">In Section 6, PCFGs are studied from the random branching process point of view.</S>
			<S sid ="128" ssid = "128">Finally, in Section 7, identifiability of production probabilities and their approximation are addressed.</S>
			<S sid ="129" ssid = "129">· 2.</S>
			<S sid ="130" ssid = "130">Notations and Definitions In this section, we collect the notations and definitions we will use for the remaining part of the paper.</S>
			<S sid ="131" ssid = "131">Definition 1 A context-free grammar (CFG) G is a quadruple (N, T,R, S), where N is the set of variables, T the set of terminals, R the set of production rules, and S E N is the start symbol.2 Elements of N are also called nonterminal symbols.</S>
			<S sid ="132" ssid = "132">N, T, and R are always 2 Some of our discussion requires that each sentential form have only finitely many parses.</S>
			<S sid ="133" ssid = "133">For this.</S>
			<S sid ="134" ssid = "134">reason, we shall assume that in G, there are no null or unit productions.</S>
			<S sid ="135" ssid = "135">assumed to be finite.</S>
			<S sid ="136" ssid = "136">Let n denote the set of finite parse trees of G, an element of which is always denoted as T . For each T E n and each production rule ( A -+ o:) E R, define f (A -+ o:;T) to be the number of occurrences, or frequency, of the rule in T , and f ( A; T ) to be the number of occurrences of A in T .f (A; T ) and f ( A -+ o:;T) are related by aE(NUT)* s.t.</S>
			<S sid ="137" ssid = "137">(A----&gt;a)ER f (A -+ o:;T).</S>
			<S sid ="138" ssid = "138">Define h(T ) as the height of T, which is the number of nonterminal nodes on the longest route from T&apos;s root to its terminal nodes.</S>
			<S sid ="139" ssid = "139">Define ITI as the size of T, which is the total number of nonterminal nodes in T . For any A E N and any sentential form &apos;Y E (N U T)*, define n( A; &apos;Y) as the number of instances of A in &apos;Y· Define bl as the length of the sentential form.</S>
			<S sid ="140" ssid = "140">Definition 2Let A E T denote that the symbol A occurs in the parse T . If A E T, let TA be the left most maximum subtree of T rooted in A, which is the subtree of T rooted in A satisfying the condition that if T 1 &apos;I- TA is also a subtree of T rooted in A, then T 1 is either a subtree of TA, or a right sibling of TA, or a subtree of a right sibling of TA.</S>
			<S sid ="141" ssid = "141">Let AT be the root of TA, which is the leftmost &quot;shallowest&quot; instance of A in T . Definition 3 For any two symbols A E N and B E N U T, not necessarily different, B is said to be reachable from A in G, if there is a sequence of symbols A0,A1,...,An with Ao = A and An = B, and a sequence of sentential forms o:o, . . .,O:n-1, such that each A; -+ o:; is a production in R and each o:; contains the next symbol A;+l· G is called connected if all elements in N U T can be reached from all nonterminal symbols.</S>
			<S sid ="142" ssid = "142">We now define the probabilistic version of reachability in CFG.</S>
			<S sid ="143" ssid = "143">Suppose p is a distribution on n. For any two symbols A E N and B E N U T, not necessarily different, B is said to be reachable from A in G under p, if there is a T E n with p( T) &gt; 0 and there is a subtree T 1 of T, such that T 1 is rooted in A and B E T 1• G is called connected under p if all symbols in N U T can be reached from all nonterminal symbols under p. Definition 4 A system of production probabilities of G is a function p : R -+ [0, 1] such that for any A E N, aE(NUT)* s.t.</S>
			<S sid ="144" ssid = "144">(A----&gt;a)ER p( A -+ o:) = l.</S>
			<S sid ="145" ssid = "145">(3) We will also use p to represent the PCFG probability distribution on parses im­ posed by p, via the formula p(T ) = IT p( A -+ a)f( A----&gt;a;T ).</S>
			<S sid ="146" ssid = "146">(A----&gt;a)ER (4) Similarly, for any estimated system of production probabilities p, we will also use p to represent the probability distribution on parses imposed by p. We will write p(O ) as the total probability of all finite parse trees in 0.</S>
			<S sid ="147" ssid = "147">Definition 5 Now we introduce a notation in statistics.</S>
			<S sid ="148" ssid = "148">Let p be an arbitrary distribution on O and g(T ) a function of T E 0.</S>
			<S sid ="149" ssid = "149">The expected value of g under the distribution p, denoted Epg(T ), is defined as Epg(T ) = p(T )g(T ).</S>
			<S sid ="150" ssid = "150">rEl1 Definition 6 All the parse trees we have so far seen are rooted in S. It is often useful to investigate subtrees of parses, therefore it is necessary to consider trees rooted in symbols other than S. We call a tree rooted in A E N a parse (tree) rooted in A if it is generated from A by the production rules in R. Let OA be the set of all finite parse trees with root A. Define PA as the probability distribution on OA imposed by a system of production probabilities p, via (4).</S>
			<S sid ="151" ssid = "151">Also extend the notions of height and size of parses to trees in 0,A, When we write PA(T ), we always assume that T is a parse tree rooted in A. When p = PA, Epg(T ) equals Epg(T ) = LnA PA(T )g(T ).</S>
			<S sid ="152" ssid = "152">We will use p(OA ) instead of PA(OA) to denote the total probability of finite parse trees in OA.</S>
			<S sid ="153" ssid = "153">With no subscripts, 0 and p are assumed to be Os and ps, respectively.</S>
			<S sid ="154" ssid = "154">For convenience, we also extend the notion of trees to terminals.</S>
			<S sid ="155" ssid = "155">For each terminal t E T, define 01 as the set of the single &quot;tree&quot; {t}.</S>
			<S sid ="156" ssid = "156">Define p1( t) = 1, f tl = 0 and h( t) = 0.</S>
			<S sid ="157" ssid = "157">For this paper we make the following assumptions: 1.</S>
			<S sid ="158" ssid = "158">For each symbol A -/- S, there is at least one parse T with root S such that.</S>
			<S sid ="159" ssid = "159">A E T. This will guarantee that each A -/- S can be reached from S; each production rule (A --+ a) E R is assumed to have positive probability, i.e., p( A --+ a) &gt; 0.</S>
			<S sid ="160" ssid = "160">This guarantees that there are no useless productions in the PCFG.</S>
			<S sid ="161" ssid = "161">3.</S>
			<S sid ="162" ssid = "162">Relative Weighted Frequency.</S>
			<S sid ="163" ssid = "163">The relative weighted frequency method is motivated by the maximum-likelihood (ML) estimation of production probabilities.</S>
			<S sid ="164" ssid = "164">We shall first give a brief review of ML estimation.</S>
			<S sid ="165" ssid = "165">We consider two cases of ML estimation.</S>
			<S sid ="166" ssid = "166">In the first case, we assume the data are fully observed, which means that all the samples are fully observed finite parses trees.</S>
			<S sid ="167" ssid = "167">Let T1, Tz,.</S>
			<S sid ="168" ssid = "168">..,Tn be the samples.</S>
			<S sid ="169" ssid = "169">Then the ML estimate of p( A --+ a) is the ratio between the total number of occurrences of the production A --+ a in the samples and the total number of occurrences of the symbol A in the samples, n Lf (A ----+ a; T;) p( A ----+ a) = _i=_l_n _ Lf (A;T;) i=1 (5) Because of the form of the estimator in (5), ML estimation in the full observa­ tion case is also called relative frequency estimation in computational linguistics.</S>
			<S sid ="170" ssid = "170">This simple estimator, as shown by Chi and Geman (1998), assigns proper production prob­ abilities for PCFGs.</S>
			<S sid ="171" ssid = "171">In the second case, the parse trees are unobserved.</S>
			<S sid ="172" ssid = "172">Instead, the yields Y1 = Y(T1), ...1 Yn = Y(Tn), which are the left-to-right sequences of terminals of the un­ known parses T1, . . .</S>
			<S sid ="173" ssid = "173">, Tn, form the data.</S>
			<S sid ="174" ssid = "174">It can be proved that the ML estimate p is given by n L E;,[ J( A ----+ a;T ) IT E fh.]</S>
			<S sid ="175" ssid = "175">p( A ----+ a) = _i=_l_n _ L E;,[ J( A; T ) IT E Dy; ] i=1 where Dy is the set of all parses with yield Y, i.e., Dy = {T E D : Y( T ) = Y}.</S>
			<S sid ="176" ssid = "176">(6) Equation (6) cannot be solved in closed form.</S>
			<S sid ="177" ssid = "177">Usually, the solution is computed by the EM algorithm with the following iteration (Baum 1972; Baker 1979; Dempster, Laird, and Rubin 1977): n L E;,k [ f ( A ----+ a; T ) IT E D y;] Pk+1 (A ----+ a) = _i=_l_n _ L E;,k [ f (A; T ) IT E Oyj] i=1 (7) Like p in (5), Pk for k &gt; 0 impose proper probability distributions on D (Chi and Geman 1998).</S>
			<S sid ="178" ssid = "178">To unify (6) and (7), expand E;,k [ f ( A ----+ a; T ) IT E Oy;], by the definition of expecta­ tion, into E;,k [f ( A ----+ a;T ) IT E D y;] = L f (A ----+ a;T )Pk(T IT E OyJ TE!1yj Let A be the set of parses whose yields belong to the data, i.e., A = {T : Y(T ) E {Y1, ...,Yn}}, For each T E A, let y = Y( T ) and W( T ) = L Pk( T IT E Dy ), i:Y;=y Then we observe that, for any production rule A ----+ a, n n =* LE,,Jf (A - a; T)IT E Oy;] = Lf (A - a; T)W (T ).</S>
			<S sid ="179" ssid = "179">i=l TEA Therefore, (7) is transformed into Lf(A - a;T )W (T )Pk+la = __f_(_A_; T_)_W_(_T ) TEA The ML estimator in (6) can also be written in the above form, as can be readily checked by letting A be the set {T1, . . .,Tn } and W(T ), for each T E A, be the number of occurrences of T in the data.</S>
			<S sid ="180" ssid = "180">In addition, in both full observation cases and partial observation cases, we can divide the weights of W(T ) by a constant so that their sum is 1.</S>
			<S sid ="181" ssid = "181">The above discussion leads us to define a procedure to assign production proba­ bilities as follows.</S>
			<S sid ="182" ssid = "182">First, pick an arbitrary finite subset A of n,with every production rule appearing in the trees in A. Second, assign to each T E A a positive weight W(T ) such that I:TEA W(T ) = 1.</S>
			<S sid ="183" ssid = "183">Finally, define a system of production probabilities p by Lf (A - a; T)W (T ) p ( A - a) = TEAf (A; T_)_W(_T ) (8) TEA Because of the similarity between (5) and (8), we call the procedure to assign produc­ tion probabilities by (8) the &quot;relative weighted frequency&quot; method.</S>
			<S sid ="184" ssid = "184">Proposition 1 Suppose all the symbols of N occur in the parses of A, and all the parses have positive weight.</S>
			<S sid ="185" ssid = "185">Then the production probabilities given by (8) impose proper distributions on parses.</S>
			<S sid ="186" ssid = "186">Proof The proof is almost identical to the one given by Chi and Ceman (1998).</S>
			<S sid ="187" ssid = "187">Let qA = p (derivation tree rooted in A fails to terminate).</S>
			<S sid ="188" ssid = "188">We will show that qs = 0 (i.e., derivation trees rooted in S always terminate).</S>
			<S sid ="189" ssid = "189">For each A E V, let ]( A;T ) be the number of non­ root instances of A in T. Given a E (V U T) *, let ai be the ith symbol of the sentential form a. For any A E V qA p ( LJ LJ{derivation begins A -a; and a; fails to terminate}) (A---&gt;a)ER i L p( A - a)p ( LJ{a; fails to terminate}) (A---&gt;a)ER i &lt; L p( A - a) Lp( {a; fails to terminate}) (A---&gt;a)ER L p( A - a) I: n( B; a)q 8 ( A---&gt;a)ER BEV Sum over A E V: AEV TEA BEV TEA AEV (A-+a)ER L qB Lf ( B; T )W (T ) BEV TEA i.e., L qA Lif ( A; T ) -f (A;T ) )W ( T ) 2:: 0 AEV TEA Clearly, for every T E A, j( A;T ) = f ( A;T ) whenever A =/- S and j( S;T ) = f ( S;T ) - 1.</S>
			<S sid ="190" ssid = "190">Hence q5 = 0, completing the proof.</S>
			<S sid ="191" ssid = "191">D Corollary 1 Under the same assumption of Proposition 1, for each symbol A E N, p( OA) = 1.</S>
			<S sid ="192" ssid = "192">Proof For any A E N, there is a T E A such that A E T . Since p( T ) &gt; 0, this implies A is reachable from S under p. Using the notation given in Definition 2, we have qs &gt; p( {A E T and TA fails to terminate}) p( {TA fails to terminate}IA E T ) p( A E T) =} p( {TA fails to terminate}IA E T) = 0, since q5 = 0 and p( A E T ) &gt; 0.</S>
			<S sid ="193" ssid = "193">By the nature of PCFGs, the form of TA is distributed according to PA, independent of its location in T or of the choice of subtrees elsewhere in T . Therefore the conditional probability of TA failing to terminate, given that A occurs in T , equals qA, proving that qA = 0.</S>
			<S sid ="194" ssid = "194">D 4..</S>
			<S sid ="195" ssid = "195">Entropy and Moments of Parse Tree Sizes.</S>
			<S sid ="196" ssid = "196">In this section, we will first show that if production probabilities are assigned by the relative weighted frequency method, then they impose PCFG distributions under which parse tree sizes have finite moment of any order.</S>
			<S sid ="197" ssid = "197">Based on this result, we will then demonstrate that such PCFG distributions have finite entropy and give the explicit form of the entropy.</S>
			<S sid ="198" ssid = "198">The mth moment of sizes of parses is given by Er l Tlm = L p(T ) IT l m TEil &apos; and the entropy of a PCFG distribution p is given by 1 H(p) = L p( T ) log ( T )&apos; TE fl p To make the proofs more readable, we define, for any given A = {T1, . . .,Tn}, for any ( A -+ a) E R, and F( A -+ a) = Lf (A -+ a;T) W(T), TEA F(A) = I: aE(NUT)* s.t.</S>
			<S sid ="199" ssid = "199">(A----,a)ER F( A -+ a) = Lf ( A;T )W (T ), TEA for any A E N; that is, F( A -+ a) is the weighted sum of the number of occurrences of the production rule A -+ a in A and F(A) is the weighted sum of the number of occurrences of A in A. The relative weighted frequency method given by (8) can be written as F( A -+ a) p( A -+ a) = F(A) (9) We have the following simple lemma: Lemma 1 For any A E N, and LF(A) = LI TI W(T) AEN TEA (10) I: I: BEN &apos;Y s.t.</S>
			<S sid ="200" ssid = "200">(B----,&apos;Y)ER F(S) - 1 F( B -+ &apos;Y )n( A; &apos;Y) = { F(A) if A = S if A # S (11) (If I::TEA W(T) # 1, F(S) -1 should be changed to F(S) - I::TEA W(T).)</S>
			<S sid ="201" ssid = "201">Proof For the first equation, AEN AEN TEA TEA AEN TEA For the second equation, L L F( B -+ &apos;Y )n( A; &apos;Y) BEN &apos;Y s.t.</S>
			<S sid ="202" ssid = "202">(B----,&apos;Y)ER L L Lf ( B -+ &quot;(;T )W (T )n( A; &apos;Y) B E N &apos; Y s . t . T E A ( B , &apos; Y ) E R L W(T) L L f ( B -+ &quot;(; T )n( A; &apos;Y) (12) TEA BEN &apos;Y s.t.</S>
			<S sid ="203" ssid = "203">( B , &apos; Y ) E R For each A, L L f ( B -+ &quot;(;T )n( A; &apos;Y) B E N , s . t .</S>
			<S sid ="204" ssid = "204">( B &gt; , ) E R is the number of nonroot instances of A in T . When A =f. S, the number of nonroot instances of A in T is equal tof (A; T ).</S>
			<S sid ="205" ssid = "205">Substitute this into (12) to prove (11) for the case A =f. S. The case A = S is similarly proved.</S>
			<S sid ="206" ssid = "206">D Proposition 2 Suppose all the symbols in N occur in the parses of A, and all parses have posi­ tive weights.</S>
			<S sid ="207" ssid = "207">If the production probabilities p are assigned by the relative weighted frequency method in (8), then for each m E N U {O}, EplT l m &lt; oo.</S>
			<S sid ="208" ssid = "208">Proof We shall show that for any A E N, if p = PA, then EplT l m &lt; oo.</S>
			<S sid ="209" ssid = "209">When m = 0, this is clearly true.</S>
			<S sid ="210" ssid = "210">Now suppose the claim is true for 0, . . .,m - l.For each A E N and k E N, define M k,A = L PA(T ) IT l m , rErlA h( r):S;k It is easy to check L (1+ LIT;l )m p( A -+ a)pa,(71) ·· ·PaL ( TL), (13) aE(NUT)* TI,···,TL i=l (A---&gt;a)ER T;Erlo; h( r;):S;k where for ease of typing, we write L for l al. For fixed a, write L L (1 + Lhl)m = P( IT1I, . ·- , ITL I ) + LI T;lm , i=l i=l P is a polynomial in I T1I, . . .</S>
			<S sid ="211" ssid = "211">, ITL I, each term of which is of the form (14) By induction hypothesis, there is a constant C &gt; 1, such that for all O :::; s &lt; m and A E N U T, L PA (7)17l5 = EpA IT IS &lt; C. rErlA Then for each term with the form given in (14), L h l 81 . . .</S>
			<S sid ="212" ssid = "212">hlSLPa1 (T1) . . ·PaL(TL ) = 11 L hl 81Pa1 (T;) :::; cL. Tl ,•• •,TL TjE11o:j There are less than Lm = f or terms in P( hI,...,h f ).</S>
			<S sid ="213" ssid = "213">Hence L P( [T1 [ , . . ., hf )p( A --+ a)pa1 (T1) . . .p°&apos; L(TL) :S: f arcl&lt;&gt;I. T1 ,..</S>
			<S sid ="214" ssid = "214">,,T&apos;L TiE00 i h( ri ):S k So we get aE(NUT)* s.t.</S>
			<S sid ="215" ssid = "215">(A-,a)ER l&lt;&gt;I + L L [T;[ mp( A --+ a)Pa1 (T1) ···P°&apos;lal ha1) aE(NUT)* TJ,···,71 al i=l s.t.</S>
			<S sid ="216" ssid = "216">(A-&gt;a)ER Ti E!lai h( ri ):Sk &lt; aE(NUT)* s.t.</S>
			<S sid ="217" ssid = "217">(A-&gt;a)ER lal L M k,ai p( A --+ a).</S>
			<S sid ="218" ssid = "218">&lt;&gt;E(NUT)* i=l s.t.</S>
			<S sid ="219" ssid = "219">(A-&gt;a)ER Because the set of production rules is finite, the length of a sentential form that occurs on the right-hand side of a production rule is upper bounded, i.e., sup{[ a f : for some A E N, ( A --+ a) E R} &lt; oo.</S>
			<S sid ="220" ssid = "220">Therefore we can bound ( f a[ + 1tcl0 I by a constant, say, K. Then we get ial L M k,ai p( A --+ a).</S>
			<S sid ="221" ssid = "221">(15) aE(NuT)* i=l s.t.</S>
			<S sid ="222" ssid = "222">(A-,a)ER Replace p( A --+ a) by F( A --+ a)/ F( A), then multiply both sides of (15) by F( A) and sum over all A E N with F( A) &gt; 0.</S>
			<S sid ="223" ssid = "223">By (10) and (11), we then get lal L L M k,al( A --+ a) (by (10) ) rEA AEN aE(NUT)* i=l s.t.</S>
			<S sid ="224" ssid = "224">(A-&gt;a)ER L L n( B; a)M k,BF( A --+ a) rEA AEN aE(NUT)* BEN s.t.</S>
			<S sid ="225" ssid = "225">(A-&gt;a)ER n( B; a)F( A --+ a) rEA BEN AEN &lt;&gt;E(NUT)* s.t.</S>
			<S sid ="226" ssid = "226">(A-&gt;a)ER K L [ T[ W(T) + L M k,BF( B ) +M k,s( F( S ) -1).</S>
			<S sid ="227" ssid = "227">(by (11)) rEA B,f.S Because for each A E N, M k+l ,A ?:: M k,A, we get L M k,AF( A) :S: K L ITI W(T) + L M k,AF( A) + Mk,s(F(S) - 1) AEN rEA A,f.S ===?</S>
			<S sid ="228" ssid = "228">M k,S :S: K L ITI W(T) &lt; 00.</S>
			<S sid ="229" ssid = "229">rEA Letting k --+ oo, by M k,S iE p 5 1T l m, we get Ep 5 1 T l m :::; K &quot;I:,rEA ITIW(T) &lt; oo.</S>
			<S sid ="230" ssid = "230">To complete the induction, we shall show for every A E N U T other than S, EPA IT i m &lt; oo.</S>
			<S sid ="231" ssid = "231">By conditional expectation, there is (see Definition 2 for the notations A E T and since ps( A E T) &gt; 0.</S>
			<S sid ="232" ssid = "232">Because hi &lt; ITI, Eps( ITAl m IA E T) &lt; oo.</S>
			<S sid ="233" ssid = "233">As in the proof of Corollary 1, TA is independent of its location and other part of T, and is distributed by PA· Therefore From Proposition 2 it follows that the mean size of parses is finite under p. Since f (A --+ a;T ) :::; ITI for each production A --+ a, it follows that the mean frequency of f (A --+ a; T) is finite.</S>
			<S sid ="234" ssid = "234">The next proposition gives the explicit form of the mean frequency in terms of the production probabilities assigned by the relative weighted frequency method.</S>
			<S sid ="235" ssid = "235">Proposition 3 Under the same conditions of Proposition 2, the mean frequency of the production rule ( A --+ a) E R is the weighted sum of the numbers of its occurrences in parses of A, with weights W(T ), i.e., E pf (A --+ a;T ) = Lf (A --+ a;T )W (T ) rEA (17) Proof Fix ( A --+ a) E R. For each C E N, write E(C) for Epcf ( A --+ a; T ).</S>
			<S sid ="236" ssid = "236">We shall find the linear relations between E(C).</S>
			<S sid ="237" ssid = "237">To this end, for each T E De, let C --+ 1be the production rule applied to T 1s root.</S>
			<S sid ="238" ssid = "238">Suppose I is composed of m symbols, 11, . . ., rm, and T1, . . .,Tm are the daughter subtrees of T rooted in 11, . . .,rm, respectively.</S>
			<S sid ="239" ssid = "239">Then m f (A --+ a;T ) = x( C --+ 1) + Lf ( A --+ a; Tk ), k=l where x(C --+ ) = { if C --+ 1=/=- A -+ a, otherwise.</S>
			<S sid ="240" ssid = "240">Multiply both sides by p( T ) and sum over all T E De which have C --+ 1 as the production rule applied at the root.</S>
			<S sid ="241" ssid = "241">By the definition of PCFG, p( T ) = p( C --+ r)p(r1) ···p( rm), and Tk can be any parse in n..Yk&apos; Therefore, by factorization, we get L x(C - &apos;Y)p(r) TE!!c--., L x ( C _ , &apos; Y ) p ( C _ , &apos; Y ) p ( r 1 ) · · · p ( r r n ) r n p( C _, &apos;Yh(C _, &apos;Y) IJ p(O,,k ) k = l p( C -&apos;Y)x(C -&apos;Y), (All p( O,,k ) = 1by Proposition 1), where Oc_,,, stands for the set of trees in which C _, &apos;Y is the rule applied at the root.</S>
			<S sid ="242" ssid = "242">Similarly, for each k, L f ( C -&quot;(;Tk )P(T ) TE!!c--., rn p(C -&apos;Y) L f ( C -&quot;( ; Tk )Ph) IJ p( r;) i=l i# p( C _, &apos;Y)E(&apos;Yk).</S>
			<S sid ="243" ssid = "243">Therefore we get L p( r)f (A _, a;T ) TE!!c--., m p(C -&apos;Y) (x(c -&apos;Y) + L E(&apos;Yk)) k = l p( C -&apos;Y)(x(C -&apos;Y) + L n(B;&apos;Y)E(&apos;Yk)).</S>
			<S sid ="244" ssid = "244">B E N s.t. BE, &apos; Sum over all production rules for C. The left-hand side totals E(C) and E(C) = p( C -&apos;Y) (x(C -&apos;Y) + L n( B; &apos;Y)E(B)).</S>
			<S sid ="245" ssid = "245">,&apos;E(NUT)* s.t.</S>
			<S sid ="246" ssid = "246">(C-,l&apos;) ER B E N s.t. BEi&apos; Replace p( C _, &apos;Y) by F(C _, &apos;Y)/F(C), according to (9).</S>
			<S sid ="247" ssid = "247">Then multiply both sides by F(C) and sum both sides over all C E N. We get L F(C)E(C) CEN CEN ,&apos;E(NuT)* s.t.</S>
			<S sid ="248" ssid = "248">(C-,,&apos;)ER F(C _, &apos;Y)x(C _, &apos;Y) F(C _, &apos;Y) L n(B; &apos;Y)E(B) CEN ,&apos;E(NUT)* s.t.</S>
			<S sid ="249" ssid = "249">(C-,l&apos;)ER BEN s.t. BEi&apos; F(A _, a) + L E(B) L L F(C _, &apos;Y)n(B; &apos;Y) BEN CEN I&apos; s.t.</S>
			<S sid ="250" ssid = "250">(C-,,&apos;)ER F( A _, a) + LE(B)F(B) - E(S) (By (11)) BEN ==;.</S>
			<S sid ="251" ssid = "251">E(S) = F( A _, a), completing the proof of (17).</S>
			<S sid ="252" ssid = "252">D Now we can calculate the entropy of p in terms of production probabilities.</S>
			<S sid ="253" ssid = "253">Corollary 2 Under the conditions in Proposition 2, 1 1 H( p) = L F( A --&gt; a) log F( A --&gt; a) - LF( A) log F( A) , (A-&gt;a)ER AEN which is clearly finite.</S>
			<S sid ="254" ssid = "254">Proof The calculation goes as follows, H( p ) = Lp( T) log rE!l p 1 (T ) L P(T) log IJ rE!l 1 p( A --&gt; a)f (A-&gt;;r ) (A-&gt;a)ER 1 LP(T ) L f (A --&gt; a;T ) log (A --&gt; a) rE!l (A-&gt;a)ER p L Lp( T )f (A --&gt; a; T ) log (A 1 a) (Exchange the order of summation) (A-&gt;a)ER rE!l p 1 L Epf( A --&gt; a;T ) log (A --&gt; a) (A-&gt;a)ER p L Lf (A --&gt; a;T) W(T) log F(!( a) (A-&gt;a)ER rEA L Lf (A --&gt; a;T )W (T ) logF( A) (A-&gt;a)ER rEA L Lf (A --&gt; a;T )W (T ) log F( A --&gt; a) (A-&gt;a)ER rEA LF( A) log F(A) - L F( A --&gt; a) log F(A --&gt; a).</S>
			<S sid ="255" ssid = "255">D (A-&gt;a)ER 5.</S>
			<S sid ="256" ssid = "256">Gibbs Distributions on Parses and Renormalization of Improper PCFGs.</S>
			<S sid ="257" ssid = "257">A Gibbs distribution on parses has the form where Z&gt;.</S>
			<S sid ="258" ssid = "258">= I:e&gt;-·U( r ), and &gt;.</S>
			<S sid ="259" ssid = "259">= {&gt;.;} and U(T ) = {U;(T)} are constants and functions on n,respectively, both indexed by elements in a finite set I. The inner product &gt;.· U = I:&gt;.;U; is called the potential function of the Gibbs distribution and Z&gt;.</S>
			<S sid ="260" ssid = "260">is called the partition number for the exponential e&gt;-·U. The functions U; are usually considered features of parses and the constants &gt;.; are weights of these features.</S>
			<S sid ="261" ssid = "261">The index set I and the functions U;(T ) can take var­ ious forms.</S>
			<S sid ="262" ssid = "262">Among the simplest choices for I is R, the set of production rules, and correspondingly, U(r) = f ( r) = {f (A ----&gt; a;r)}(A---+a)ER· (18) Given constants .X, if Z&gt;.</S>
			<S sid ="263" ssid = "263">&lt; oo, then we get a Gibbs distribution on parses given by (19) A proper PCFG distribution is a Gibbs distribution of the form in (19).</S>
			<S sid ="264" ssid = "264">To see this, let AA---+a = log p(A ----&gt; a) for each (A ----&gt; a) E R. Then p( r ) = which is a Gibbs form.</S>
			<S sid ="265" ssid = "265">A Gibbs distribution usually is not a PCFG distribution, because its potential function in general includes features other than frequencies of production rules.</S>
			<S sid ="266" ssid = "266">What if its potential function only has frequencies as features?</S>
			<S sid ="267" ssid = "267">More specifically, is the Gibbs distribution in (19) a PCFG distribution?</S>
			<S sid ="268" ssid = "268">The next proposition gives a positive answer to this question.</S>
			<S sid ="269" ssid = "269">Proposition 4 The Gibbs distribution P&gt;.</S>
			<S sid ="270" ssid = "270">given by (19) is a PCFG distribution.</S>
			<S sid ="271" ssid = "271">That is, there are production probabilities p, such that for every r E n, P&gt;,(r) = II p( A ----&gt; a)f (A---+a;r ).</S>
			<S sid ="272" ssid = "272">(A---+a)ER Proof The Gibbs distributions we have seen so far are only defined for parses rooted in S . By obvious generalization, we can define for each nonterminal symbols A the partition number Z&gt;,( A) = L e&gt;- f ( r ) r E!1A and the Gibbs distribution P(r) on parses rooted in A. For simplicity, also define Z&gt;,( t) = 1 and P1(t) = 1 for each t E T. We first show Z&gt;.( A) &lt; oo for all A. Suppose (S ----&gt; a) E R with lal = n. Thesum of e&gt;- f ( r ) over all r E Ds with S ----&gt; a being applied at the root is equal to e&gt; s-a z&gt;,( a1) . . .</S>
			<S sid ="273" ssid = "273">Z&gt;,( an), while less than the sum of e&gt;- f ( r ) over all T E Ds, which is Z&gt;.(S).</S>
			<S sid ="274" ssid = "274">Therefore, Since Z&gt;.</S>
			<S sid ="275" ssid = "275">&lt; oo and Z&gt;.( A) &gt; 0, for all A, it follows that Z&gt;.( a;) is finite.</S>
			<S sid ="276" ssid = "276">For any variable A, there are variables Ao = S,A1,.</S>
			<S sid ="277" ssid = "277">.,An = A E N and sentential forms a&lt;0), . ..,a&lt;n-l ) E (N U T)*, such that (Ai ---+ c/il ) E R and A+i E a(il, By the same argument as above, we get 1a&lt;ill Z&gt;.(Ai) 2 /A;-a(i) Z&gt;.(Dki) ), k=l where afl is the kth element in a(il.</S>
			<S sid ="278" ssid = "278">By induction, Z&gt;.</S>
			<S sid ="279" ssid = "279">(A) &lt; oo.</S>
			<S sid ="280" ssid = "280">Now for (A ---+ a) E R, with lal = n, define 1 p( A ---+ a) = Z&gt;.( A{ &gt;-A-a Z( a1) ..</S>
			<S sid ="281" ssid = "281">Z&gt;.( an), Since Z&gt;.</S>
			<S sid ="282" ssid = "282">(A) and Z&gt;.</S>
			<S sid ="283" ssid = "283">(ai) are finite, p( A ---+ a) is well defined.</S>
			<S sid ="284" ssid = "284">The p&apos;s form a system of production probabilities, because for each A E N, (20) L a) = l L IiaTl = l L =p( A ---+ - e&gt;-A-aZ&gt;.( ak ) - e&gt;- f (T ) 1 (A-+a)ER Z&gt;.</S>
			<S sid ="285" ssid = "285">(A) (A-+a)ER k=l Z&gt;.</S>
			<S sid ="286" ssid = "286">(A) TE!lA We shall prove, by induction on h(T ), that P&gt;.(r) = IT p( A ---+ a)f (A-+a;T ).</S>
			<S sid ="287" ssid = "287">(A-+a)ER When h( T) = 0, T is just a terminal, and the equation is obviously true.</S>
			<S sid ="288" ssid = "288">Suppose the equation is true for all T E DA with h( T) &lt; h, and all A E N. For any T E DA with h( T) = h, let A ---+ (J = fJ1 ...fJm be the production rule applied at the root.</S>
			<S sid ="289" ssid = "289">Then 1 1 m PA( r ) = --e&gt;.f (T ) = --e&gt;-A-/3 e&gt;- f (Tk ) Z&gt;.(A) Z&gt;.(A) k=l I where Tk is the daughter subtree of r rooted in fJk.</S>
			<S sid ="290" ssid = "290">Each Tk has height &lt; h. Hence, by induction assumption, =* PA(T ) 1 m = --e&gt;-A- /3 e&gt;- fh) Z&gt;.</S>
			<S sid ="291" ssid = "291">(A) k=l = _l_e&gt;-A- /3 ft Z&gt;.( fJk ) II p(B ---+ a)f(B-+a;Tk ) Z&gt;.</S>
			<S sid ="292" ssid = "292">(A) k=l (B-+a)ER = p( A ---+ (J) II II p( B ---+ a)f (B-+a;Tk ) k=l (B-+a)ER IT p( B ---+ a)f ( B-+a;T ) 1 (B-+a)ER proving P &gt;.</S>
			<S sid ="293" ssid = "293">is imposed by p. D Proposition 4 has a useful application to the renormalization of improper PCFGs.</S>
			<S sid ="294" ssid = "294">Suppose a PCFG distribution p on n = Ds is improper.</S>
			<S sid ="295" ssid = "295">We define a new, proper distribution p on n,by T E f2.</S>
			<S sid ="296" ssid = "296">We call p the renormalized distribution of p on n.We can also define the renormalized distribution of PA on DA, for each A E N, by (21) Comparing p with (19), we see that p is a Gibbs distribution with frequencies of production rules as features.</S>
			<S sid ="297" ssid = "297">Therefore, by Proposition 4, p is a PCFG distribution, and from the proof of Proposition 4, we get Corollary 3.</S>
			<S sid ="298" ssid = "298">Corollary 3 Suppose the production probabilities of the improper distribution p are positive for all the production rules.</S>
			<S sid ="299" ssid = "299">Then the renormalized distributions p are induced by the production probabilities p( A -+ a) = +p( A -+ a) IIp( nBt( B; a) _ p( A) BEN Therefore, p on n is a PCFG distribution.</S>
			<S sid ="300" ssid = "300">(22) Proof The only thing we have not mentioned is that &gt;.A ,a = log p( A -+ a) are all bounded, since p are all positive.</S>
			<S sid ="301" ssid = "301">D We have seen that PCFG distributions can be expressed in the form of Gibbs distri­ butions.</S>
			<S sid ="302" ssid = "302">However, from the statistical point of view, this is not enough for regarding PCFG distributions as special cases of Gibbs distributions.</S>
			<S sid ="303" ssid = "303">An important statistical issue about a distribution is the estimation of its parameters.</S>
			<S sid ="304" ssid = "304">To equate PCFG distri­ butions with special cases of Gibbs distributions, we need to show that estimators for production probabilities of PCFGs and parameters of Gibbs distributions produce the same results.</S>
			<S sid ="305" ssid = "305">Among many estimation procedures, the maximum-likelihood (ML) estimation procedure is commonly used.</S>
			<S sid ="306" ssid = "306">In the full observation case, if the data is composed of T1, . . .</S>
			<S sid ="307" ssid = "307">, Tn, then the estimator for the system of production probabilities is p = { p( A -+ a)} = arg max II II p( A -+ a) f ( A--,a;r; ), i=l (A--,a)ER (23) subject to L p ( A -+ a) = 1, (A--,a)ER for any A E N and the estimator for parameters of Gibbs distributions with ,\ of the form in (19) is A n e&gt;-·U(T; ) ,\ = arg max --, (24) &gt;.</S>
			<S sid ="308" ssid = "308">i=l 2&gt;.</S>
			<S sid ="309" ssid = "309">In addition, the ML estimate p in (23) can be analytically solved and the solution is given by Equation (5).</S>
			<S sid ="310" ssid = "310">In the partial observation case, if Y1, . . ., Yn are the observed yields, then the esti­ mators for the two distributions are p = { p( A -, a)} = arg max II L II p( A -, af ( A-&gt;a;T ), (25) i=l Y( T )=Y; (A-&gt;a)ER subject to L p ( A -, a) = 1, (A-&gt;a)ER for any A E N, and n e&gt;-·U(T ) ,\ = arg max -, (26) l= TE Yi 2&gt;.</S>
			<S sid ="311" ssid = "311">respectively.</S>
			<S sid ="312" ssid = "312">We want to compare the ML estimators for the two distributions and see if they produce the same results in some sense.</S>
			<S sid ="313" ssid = "313">Since the parameters p serve as base numbers in PCFG distributions, whereas ,\ are exponents in Gibbs distributions, to make the comparison sensible, we take the logarithms of p and ask whether or not log p and ,\ are the same.</S>
			<S sid ="314" ssid = "314">Since the ML estimation procedure for PCFGs involves constrained optimization, whereas the estimation procedure for Gibbs distributions only involves unconstrained optimization, it is reasonable to suspect log pI Indeed, numerically log p and ,\ are different.</S>
			<S sid ="315" ssid = "315">For example, the estimator (23) only gives one estimate of the system of production probabilities, whereas the estimator (24) may yield infinitely many solutions.</S>
			<S sid ="316" ssid = "316">Such uniqueness and nonuniqueness of estimates is related to the identifiability of parameters.</S>
			<S sid ="317" ssid = "317">We will discuss this in more detail in Section 7.</S>
			<S sid ="318" ssid = "318">Despite their numerical differences, the ML estimators for PCFG distributions and Gibbs distributions with the form (19) are equivalent, in the sense that the estimates produced by the estimators impose the same distributions on parses.</S>
			<S sid ="319" ssid = "319">Because of this, in the context of ML estimation of parameters, we can regard PCFG distributions as special cases of Gibbs distributions.</S>
			<S sid ="320" ssid = "320">Corollary 4 If p is the solution of (23), then log p is a solution of ML estimation (24).</S>
			<S sid ="321" ssid = "321">Similarly, if p is a solution of (25), then log p is a solution of ML estimation (26).</S>
			<S sid ="322" ssid = "322">Hence, the estimates of production probabilities of PCFG distributions and parameters of Gibbs distributions with the form (19) impose the same distributions on parses.</S>
			<S sid ="323" ssid = "323">Proof Suppose &gt;.</S>
			<S sid ="324" ssid = "324">is a solution for (24).</S>
			<S sid ="325" ssid = "325">By Proposition 4, the Gibbs distribution P5..</S>
			<S sid ="326" ssid = "326">is imposed by a system of production probabilities p. Then p is the solution of (23).</S>
			<S sid ="327" ssid = "327">Let &gt;.</S>
			<S sid ="328" ssid = "328">= log p, i.e., &gt;.(A -+ o:) = log p(A -+ o:).</S>
			<S sid ="329" ssid = "329">Then &gt;.</S>
			<S sid ="330" ssid = "330">impose the same distribution on parses as &gt;..</S>
			<S sid ="331" ssid = "331">Therefore &gt;.</S>
			<S sid ="332" ssid = "332">are also a solution to (24).</S>
			<S sid ="333" ssid = "333">This proves the first half of the result.</S>
			<S sid ="334" ssid = "334">The second half is similarly proved.</S>
			<S sid ="335" ssid = "335">D 6.</S>
			<S sid ="336" ssid = "336">Branching Rates of PCFGs.</S>
			<S sid ="337" ssid = "337">In this section, we study PCFGs from the perspective of stochastic branching processes.</S>
			<S sid ="338" ssid = "338">Adopting the setup given by Miller and O&apos;Sullivan (1992), we define the mean matrix M of p as a I NI x I NI square matrix, with its (A, B)th entry being the expected number of variables B resulting from rewriting A: M(A,B ) = p( A -+ o:)n(B;o:).</S>
			<S sid ="339" ssid = "339">(27) aE(NUT)* s.t.</S>
			<S sid ="340" ssid = "340">(A---&gt;a)ER Clearly, M is a nonnegative matrix.</S>
			<S sid ="341" ssid = "341">We say B E N can be reached from A E N, if for some n &gt; 0, M( n)( A, B) &gt; 0, where M( n) (A, B) is the (A, B)th element of Mn.</S>
			<S sid ="342" ssid = "342">M is irreducible if for any pair A,&apos;B E N, B can be reached from A. The corresponding branching process is called connected if M is irreducible (Walters 1982).</S>
			<S sid ="343" ssid = "343">It is easy to check that these definitions are equivalent to Definition 3.</S>
			<S sid ="344" ssid = "344">We need the result below for the study of branching processes.</S>
			<S sid ="345" ssid = "345">Theorem 1: (PerronFrobenius) Let M = [mij ] be a nonnegative k x k matrix.</S>
			<S sid ="346" ssid = "346">1.</S>
			<S sid ="347" ssid = "347">There is a nonnegative eigenvalue p such that no eigenvalue of A has.</S>
			<S sid ="348" ssid = "348">absolute value greater than p. eigenvector v = (v1, . . .,vk) and a nonnegative right (column) eigenvector 3.</S>
			<S sid ="349" ssid = "349">If M is irreducible then p is a simple eigenvalue (i.e., the multiplicity of p. is 1), and the corresponding eigenvectors are strictly positive (i.e. U; &gt; 0, Vi &gt; 0 all i).</S>
			<S sid ="350" ssid = "350">The eigenvalue p is called the branching rate of the process.</S>
			<S sid ="351" ssid = "351">A branching process is called subcritical (critical, supercritical), if p &lt; 1 ( p = 1, p &gt; 1).</S>
			<S sid ="352" ssid = "352">We also say a PCFG is subcritical (critical, supercritical), if its corresponding branching process is. When a PCFG is subcritical, it is proper.</S>
			<S sid ="353" ssid = "353">When a PCFG is supercritical, it is improper.</S>
			<S sid ="354" ssid = "354">The next result demonstrates that production probabilities assigned by the relative weighted frequency method impose subcritical PCFG distributions.</S>
			<S sid ="355" ssid = "355">Proposition 5 For p assigned by the relative weighted frequency method (8) and M by (27), p &lt; 1.</S>
			<S sid ="356" ssid = "356">(28) Proof Let µ be the right eigenvector of p, as described in item (2) of Theorem 1.</S>
			<S sid ="357" ssid = "357">We have M µ = pµ.</S>
			<S sid ="358" ssid = "358">For each variable A, LM(A, B)µ( B) = pµ( A).</S>
			<S sid ="359" ssid = "359">BEN Therefore BEN aE(NUT)* s.t.</S>
			<S sid ="360" ssid = "360">(A--&gt;a)ER p( A , a)n( B; a)µ( B) = pµ( A).</S>
			<S sid ="361" ssid = "361">Replacing p( A , a) by F(A , a)/F( A), according to (9), I: BEN aE(NUT)* s.t.</S>
			<S sid ="362" ssid = "362">(A--&gt;a)ER F( A ---, a) F( A) n( B; a)µ( B) = pµ( A).</S>
			<S sid ="363" ssid = "363">Multiply both sides by F( A) and sum over A E N. By (11), LF( A)µ( A) - µ(S ) = p LF( A)µ( A).</S>
			<S sid ="364" ssid = "364">(29) AEN AEN We need to show that µ(S) &gt; 0.</S>
			<S sid ="365" ssid = "365">Assume µ(S) = 0.</S>
			<S sid ="366" ssid = "366">Then for any n &gt; 0, since Mnµ = pn µ, we have LM( nl( s,A)µ( A) = pnµ(S ) = 0.</S>
			<S sid ="367" ssid = "367">AEN For each A E N, M( n)(S,A)µ( A) = 0.</S>
			<S sid ="368" ssid = "368">Because each A E N is reachable from S under p, there is n &gt; 0 such that M( nl( s,A) &gt; 0.</S>
			<S sid ="369" ssid = "369">So we get µ( A) = 0.</S>
			<S sid ="370" ssid = "370">Hence µ = 0.</S>
			<S sid ="371" ssid = "371">This contradicts the fact that µ is a nonnegative eigenvector of M. Therefore µ(S ) &gt; 0.</S>
			<S sid ="372" ssid = "372">By (29), LF( A)µ( A) &gt; p LF( A)µ( A) ;::: 0 AEN AEN This proves p &lt; 1.</S>
			<S sid ="373" ssid = "373">D We will apply the above result to give another proof of Proposition 2.</S>
			<S sid ="374" ssid = "374">Before doing this, we need to introduce a spectral theorem, which is well-known in matrix analysis.</S>
			<S sid ="375" ssid = "375">Theorem 2 Suppose M is an n x n real matrix.</S>
			<S sid ="376" ssid = "376">Let O&quot;(M) be the largest absolute value of M&apos;s eigenvalues.</S>
			<S sid ="377" ssid = "377">Then O&quot;(M) = lim IIMn 111/n&apos; n--&gt;oo where IIMII is the norm of M defined by IIMII = sup IMvl.</S>
			<S sid ="378" ssid = "378">liil=l Now we can prove the following result.</S>
			<S sid ="379" ssid = "379">Proposition 6 If M given by (27) has branching rate p &lt; 1, then for each m E N U {O}, (30) Proof We repeat the proof of Proposition 2 from Section 4 up to (15).</S>
			<S sid ="380" ssid = "380">Then, instead of sum­ ming over A, we observe that (15) can be written as M k+l, A ::; K + L M ( A,B)M k, B· BEN Write {M k, A }AE N as Mb which is a vector indexed by A E N. We then have where 1 is defined as {l,.</S>
			<S sid ="381" ssid = "381">.,1}, and for two-column vectors [i and iJ, [i ::; iJ means each component of µ is ::; the corresponding component of v. Since the components in Kl, M and M k are positive, the above relation implies Hence, we get By induction, we get k-2 M k &lt;_ K&quot;M jl + M k-lM 1, j=O k-2 ===} IMkl :S K L IIMlllll + IIMklll lM1l­ j=O (31) By Theorem 2, for any p &lt; p &apos; &lt; 1, IIMnll = o( p &apos;n).</S>
			<S sid ="382" ssid = "382">Then (31) implies that IMkl is bounded.</S>
			<S sid ="383" ssid = "383">Since M k are positive and increasing, it follows that M k converge.</S>
			<S sid ="384" ssid = "384">D Next we investigate how branching rates of improper PCFGs change after renor­ malization.</S>
			<S sid ="385" ssid = "385">First, let us look at a simple example.</S>
			<S sid ="386" ssid = "386">Consider the CFG given by (1).</S>
			<S sid ="387" ssid = "387">Assign probability p to the first production (S ----+ SS), and 1- p to the second one (S ----+ a).</S>
			<S sid ="388" ssid = "388">It was proved that the total probability of parses is min(l, 1/p-l).</S>
			<S sid ="389" ssid = "389">If p &gt; 1/2, then min(l, 1/p - 1) = l / p - 1&lt; 1, implying the PCFG is improper.</S>
			<S sid ="390" ssid = "390">To get the renor­ malized distribution, take a parse T with yield am.</S>
			<S sid ="391" ssid = "391">Since f (S ---+ S S; T ) = m - 1 and f ( S ---+ a;T ) = m, p( T ) = pm1(1rr.Then the renormalized probability of T equals Therefore, p is assigned by a system of production probabilities p with p( S ---+ SS) = 1- p &lt; 1/2, and p( S ---+ a ) = p. So the renormalized PCFG is subcritical.</S>
			<S sid ="392" ssid = "392">More generally, we have the following result, which says a connected, improper PCFG, after being renormalized, becomes a subcritical PCFG.</S>
			<S sid ="393" ssid = "393">Proposition 7 If p is a connected, improper PCFG distribution on parses, then its renormalized ver­ sion p is subcritical.</S>
			<S sid ="394" ssid = "394">Proof We have O &lt; p( rls ) &lt; 1, and we shall first show, based on the fact that the PCFG is connected, that all O &lt; p( OA) &lt; 1.</S>
			<S sid ="395" ssid = "395">Recall the proof of Corollary 1.</S>
			<S sid ="396" ssid = "396">There we got the relation qs 2 qAps( A E T ), where qA is the probability that trees rooted in A fail to terminate.</S>
			<S sid ="397" ssid = "397">Because the PCFG is connected, S is reachable from A, too.</S>
			<S sid ="398" ssid = "398">By the same argument, we also have qA 2 qspA( S E T).</S>
			<S sid ="399" ssid = "399">Since both qs and PA( S E T ) &gt; 0, qA &gt; 0, then p( OA) = 1qA &lt; 1.</S>
			<S sid ="400" ssid = "400">Similarly, we can prove p( OA) 2 p( rl s )PA( S E T) &gt; 0.</S>
			<S sid ="401" ssid = "401">For each A, define generating functions {gA} as in Harris (1963, Section 2.2), o:E(NUT)* BEN s.t.</S>
			<S sid ="402" ssid = "402">(A---&gt;a)ER where s = {sA}AEN· Write g = {gA }AEN and define g(n) = {g,\;1l} recursively as (32) (33) It is easy to see that gA( O) is the total probability of parses with root A and height 1.</S>
			<S sid ="403" ssid = "403">By induction, g,\;1 ) (0) is the total probability of parses with root A and height ::; n..</S>
			<S sid ="404" ssid = "404">Therefore, gl ( o) ip( rlA ) &lt; 1.</S>
			<S sid ="405" ssid = "405">Write r = { p( OA)}AEN· Then g( r) = g( lim g&lt;nl( o) ) = lim g( g&lt;nl( o) ) = lim g&lt;n+l ) (0) = r. n---+oo n---+oo n---+oo Therefore, r is a nonnegative solution of g( s ) = s. It is also the smallest among such solutions.</S>
			<S sid ="406" ssid = "406">That is, if there is another nonnegative solution r&apos; &apos;I r, then r ::; r&apos; . This is because O ::; r&apos; implies g( n) (0) ::; g( n) ( r&apos; ) = r&apos; for all n &gt; 0, and by letting n ---+ oo, r ::; r&apos; . Clearly, 1is also a solution of g( s ) = s. We now renormalize p to get p by (22).</S>
			<S sid ="407" ssid = "407">Define generating functions f = {fA } of p and J&lt;n ) in the same way as (32) and (33).</S>
			<S sid ="408" ssid = "408">Then fA( s ) = L p( A ---+ a) IT s;(B;o:) o:E(NUT)* BEN s.t.</S>
			<S sid ="409" ssid = "409">(A---&gt;o:)ER1p(A ---+ a) IIrnB( B;a ) IIsBn( B;a ) , aE(NuT)* rA BEN BEN s.t.</S>
			<S sid ="410" ssid = "410">(A---&gt;a)ER (34) For two vectors r = { rA} and {sA}, write rs for { rAsA }, and r/ s for { rA/ sA }.</S>
			<S sid ="411" ssid = "411">Then (34) can be written f ( s ) = g( rs) . r Since all rA == p( O.A) are positive,f (s) are well defined by the fractions.</S>
			<S sid ="412" ssid = "412">Because r is the smallest nonnegative solution of g( s ) = s, by the above equation, 1is the only solution of f ( s ) = s in the unit cube.</S>
			<S sid ="413" ssid = "413">Since g( s ) = s also has a solution 1, f ( s ) = s has a solution 1/ r, which is strictly larger than 1.</S>
			<S sid ="414" ssid = "414">We want to know how f changes on the line segment connecting 1 and 1/ r. Let u = 1/ r - 1.</S>
			<S sid ="415" ssid = "415">Then u is strictly positive.</S>
			<S sid ="416" ssid = "416">Elements on the line segment between 1 and l/ r can be represented by 1+ tu, with t E [O, l].</S>
			<S sid ="417" ssid = "417">Define h( t) = f ( l + tu) - 1- u. Then hA( t) = L p( A ---+ a) II(1 + tuB?( B;a ) - 1tuA.</S>
			<S sid ="418" ssid = "418">aE(NUT)* BEN s.t.</S>
			<S sid ="419" ssid = "419">(A---&gt;a)ER (35) Differentiate h at t = 0.</S>
			<S sid ="420" ssid = "420">Then h&apos; (0) = M u-u,where M is the mean matrix corresponding to p. Every hA (t) is a convex function.</S>
			<S sid ="421" ssid = "421">Then, because hA (0) = hA (l) = 0, h (0) :S: 0, which leads to M u :S: u. We now show that for at least one A, ( M u)A &lt; UA.</S>
			<S sid ="422" ssid = "422">First of all, note that h(O) = 0 only if hA ( t) is linear.</S>
			<S sid ="423" ssid = "423">Assume M u = u, which leads to h&apos; (0) = 0 and the linearity of h( t).</S>
			<S sid ="424" ssid = "424">Together with h( O) = 0, this implies h( t) = 0.</S>
			<S sid ="425" ssid = "425">Choose t &lt; 0 such that 1+ tuA &gt; 0 for all A. Thenf (l + tu) - 1tu = h( t) = 0.</S>
			<S sid ="426" ssid = "426">Therefore 1+ tu is a nonnegative solution of f ( s ) = s and is strictly less than 1.</S>
			<S sid ="427" ssid = "427">This contradicts the fact that 1 is the smallest nonnegative solution of f (s) = s. Now we have M u :S: u, and 3A, s.t.</S>
			<S sid ="428" ssid = "428">( M u)A &lt; UA.</S>
			<S sid ="429" ssid = "429">Because p is connected, M is irreducible.</S>
			<S sid ="430" ssid = "430">By item (3) of Theorem 1, u is strictly positive, and there is a strictly positive left eigenvector v such that vM = pv.</S>
			<S sid ="431" ssid = "431">Therefore vM u &lt; vu, or pvu &lt; vu.</S>
			<S sid ="432" ssid = "432">Hence p &lt; 1.</S>
			<S sid ="433" ssid = "433">This completes the proof.</S>
			<S sid ="434" ssid = "434">D 7.</S>
			<S sid ="435" ssid = "435">Identifiability and Approximation of Production Probabilities of PCFGs.</S>
			<S sid ="436" ssid = "436">Identifiability of parameters is related to the consistency of estimates, both being im­ portant statistical issues.</S>
			<S sid ="437" ssid = "437">Proving the consistency of the ML estimate of a system of production probabilities given in (5) is relatively straightforward.</S>
			<S sid ="438" ssid = "438">Consistency in this case means that, if p imposes a proper distribution, then as the size of the data com­ posed of independent and identically distributed (i.i.d.) samples goes to infinity, with probability one, the estimate p converges to p. To see this, think of the sample parses as taken independently from a branching process governed by p. By the context-free nature of the branching process, for A E N, each instance of A selects a production A ---+ a by probability p( A ---+ a) independently of the other instances of A. As the size of the data set goes to infinity, the number of occurrences of A goes to infinity.</S>
			<S sid ="439" ssid = "439">Therefore, by the law of large numbers, the ratio between the number of occurrences of A ---+ a and the number of occurrences of A, which is p( A ---+ a), converges to p( A ---+ a), with probability one.</S>
			<S sid ="440" ssid = "440">By the consistency of the ML estimate of a system of production probabilities, we can prove that production probabilities are identifiable parameters of PCFGs.</S>
			<S sid ="441" ssid = "441">Inother words, different systems of production probabilities impose different PCFG distribu­ tions.</S>
			<S sid ="442" ssid = "442">Proposition 8 If p1, p2 impose distributions P1, P2, respectively, and p1 # p2, then Pi # P2.</S>
			<S sid ="443" ssid = "443">Proof Assume P1 = P2.</S>
			<S sid ="444" ssid = "444">Then draw n i.i.d. samples from P1.</S>
			<S sid ="445" ssid = "445">Because the ML estimator p is consistent, as n --+ oo, p --+ p1, with probability 1.</S>
			<S sid ="446" ssid = "446">Because the n i.i.d. samples can also be regarded as drawn from P2, with the same argument, p --+ p2, with probability 1.</S>
			<S sid ="447" ssid = "447">Hence p1 = p2, a contradiction.</S>
			<S sid ="448" ssid = "448">D We mentioned in Section 5 that the ML estimators (24) and (26) may produce infinitely many estimates if the Gibbs distributions on parses have the form (19).</S>
			<S sid ="449" ssid = "449">This phenomenon of multiple solutions results from the nonidentifiability of parameters of the Gibbs distributions (19), which means that different parameters may yield the same distributions.</S>
			<S sid ="450" ssid = "450">To see why parameters of Gibbs distribution (19) are nonidentifiable, we note that the frequencies of production rules are linearly dependent, L f (A --+ a; r) (A-+a)ER L n( A; a)f ( B --+ a; r), (B-+a)ER if A # S, L f ( S --+ a; r) (S-.a)ER L n( S; a)f ( B --+ a;T ) + 1.</S>
			<S sid ="451" ssid = "451">(B-+a)ER Therefore, there exists Ao # 0, such that for any r, Ao ·f ( T ) = 0.</S>
			<S sid ="452" ssid = "452">If &gt;.</S>
			<S sid ="453" ssid = "453">is a solution for (24), then for any number t, ( &gt;.</S>
			<S sid ="454" ssid = "454">+ tAo ) ·f ( r) = &gt;.</S>
			<S sid ="455" ssid = "455">·f ( r) ==&gt; e&lt;5..+t.Xo )J( r) = e&gt;..f ( r) z- = z, &apos; .x+t.xo &gt;,.</S>
			<S sid ="456" ssid = "456">==&gt; P5..+i.x/r) = P5..</S>
			<S sid ="457" ssid = "457">(r).</S>
			<S sid ="458" ssid = "458">Thus for any t, &gt;.</S>
			<S sid ="459" ssid = "459">+ tAo is also a solution for (24).</S>
			<S sid ="460" ssid = "460">This shows that the parameters of Gibbs distribution (19) are nonidentifiable.</S>
			<S sid ="461" ssid = "461">Finally, we consider how to approximate production probabilities by mean fre­ quencies of productions.</S>
			<S sid ="462" ssid = "462">Given i.i.d. samples of parses r1, . . .,Tn from the distribution imposed by p, by the consistency of the ML estimate of p given by (5), n Lf ( A --+ a; r;)/ n p( A --+ a) = _i=__n --+ p( A --+ a), Lf ( A; r;)/ n i=l with probability 1, as n -----&gt; oo.</S>
			<S sid ="463" ssid = "463">If the entropy of the distribution p is finite, then for every production rule (A -----&gt; (3) E R, tf (A -----&gt; (J;T ) -----&gt; Ep(f (A -----&gt; (J;T ) ) with probability 1, i=l p( A , a) , Ep(f (A -----&gt; a; T) ) with probability 1, Ep(f (A;T ) ) _ Ep(f (A -----&gt; a; T) ) p (A -----&gt; a) - Ep(f (A;T ) ) · If the entropy is infinite, the above argument does not work, because both the numerator and the denominator of the fraction are infinity.</S>
			<S sid ="464" ssid = "464">Can we change the fraction a little bit so that it still makes sense, and at the same time yields good approximation to p( A -----&gt; a)?</S>
			<S sid ="465" ssid = "465">One way to do this is to pick a large finite subset O&apos; of O and replace the fraction by Ep(f (A -----&gt; a; T)IT E O&apos;) Ep(f (A;T )IT E o&apos;) where Ep(f (A -----&gt; a;T )IT E O&apos;) is the conditional expectation of f (A -----&gt; a;T ) given O&apos;, which is defined as I:f (A -----&gt; a;T )p(T ) Ep(f (A -----&gt; a; T)IT E O&apos;) = -r E!!&apos;</S>
			<S sid ="466" ssid = "466">&apos;°&apos; L_.; p(T ) Because O&apos; is finite, the top of the fraction on the right-hand side is finite.</S>
			<S sid ="467" ssid = "467">Also the bottom of the fraction is positive.</S>
			<S sid ="468" ssid = "468">Therefore the conditional expectation of f is finite.</S>
			<S sid ="469" ssid = "469">The conditional expectation Ep(f (A;T )IT E O&apos;) is similarly defined.</S>
			<S sid ="470" ssid = "470">The following result shows that as O&apos; expands, the approximation gets better.</S>
			<S sid ="471" ssid = "471">Proposition 9 Suppose a system of production probabilities p imposes a proper distribution.</S>
			<S sid ="472" ssid = "472">Then for any increasing sequence of finite subsets On of O with On i0, i.e., 01 C 02 . . .</S>
			<S sid ="473" ssid = "473">C 0, On finite and UOn = 0, (A -----&gt; a) = lim Ep(f (A -----&gt; a;T )IT E On) . p n-+oo Ep(f (A;T )IT E On) To prove the proposition, we introduce the KullbackLeibler divergence.</S>
			<S sid ="474" ssid = "474">For any two probability distributions p and q on 0, the KullbackLeibler divergence between p and q is defined as where O log qg ) is defined as O for any q(T ) :::0:: 0.</S>
			<S sid ="475" ssid = "475">D(pllq) is nonnegative and equal to O if and only if p = q. One thing to note is that q need not be proper in order to make D(pl l q) nonnegative.</S>
			<S sid ="476" ssid = "476">Even when &quot;£,q(T) &lt; 1, it is still true that D(pll q) 2 0.</S>
			<S sid ="477" ssid = "477">For more about the KullbackLeibler divergence, we refer the readers to Cover and Thomas (1991).</S>
			<S sid ="478" ssid = "478">The KullbackLeibler divergence has the simple property described below, which will be used in the proof of Proposition 9.</S>
			<S sid ="479" ssid = "479">Lemma 2 If O&apos; is an arbitrary subset of n,then D(pl l q) &gt; p(O&apos;) log P (O&apos;) + (1- p(O&apos;)) log 1- p (O&apos;) . - q(O&apos;) 1- q(O&apos;) Proof Consider the KullbackLeibler divergence between the conditional distributions p( TI O&apos;) and q( TI O&apos;), which equals &apos;&quot;&quot;&quot; , p(TI O&apos;) 1 &apos;&quot;&quot;&quot; p(T ) p(O&apos;) 0 p(TI O ) log (TIO&apos;) = (O&apos;) 0 p(T ) log (T ) - log (O&apos;) 2 0 rE[l&apos; q p rE!1&apos; q q Lp(T ) log p(T ) 2 p(O&apos;) log p(O&apos;) . rE!1&apos; q( T ) q( fl&apos;) Similarly, L p(T ) log p(T ) 2 p(O \ O&apos;) log p(O \ O&apos;) 2 (1 - p(O&apos;)) log 1- p(O&apos; ) . rE!1\!1&apos; q( T ) q( fl \ fl&apos;) 1- q( fl&apos; ) The second &quot;2&quot; is because q(O) :::;: 1.</S>
			<S sid ="480" ssid = "480">These two inequalities together prove the lemma.</S>
			<S sid ="481" ssid = "481">D Proof of Proposition 9 Given n, for production probabilities q, let Kn(q) be the KullbackLeibler divergence . between the conditional distribution p( T l rln) and the distribution imposed by q, Kn(q) = Lp(T l rln ) log -p_(T_IO_n_) _ q(A --+ a)f ( A-&gt;a;r ) .</S>
			<S sid ="482" ssid = "482">(36) (A-&gt;a)ER We want to find q that minimizes Kn(q).</S>
			<S sid ="483" ssid = "483">This can be achieved by applying the Lagrange multiplier method.</S>
			<S sid ="484" ssid = "484">The condition that q is subject to is, L q( A --+ a) = 1, (A-&gt;a)ER (37) for every A E N. There are I NI such constraints.</S>
			<S sid ="485" ssid = "485">To incorporate them into the mini­ mization, we consider the function L(q) = Kn(q) + L AA ( L q( A --+ a) - 1) , AEN (A-&gt;a)ER where the unknown coefficients { &gt;.A }AE N are called Lagrange multipliers.</S>
			<S sid ="486" ssid = "486">The q that minimizes Kn( q) subject to (37) satisfies &amp;L( q) - 0 &amp;q( A -+ a) - &apos; for all (A -+ a) E R. By simple computation, this is equivalent to LJ ( A -+ a;T)P(TI On) = &gt;.Aq( A -+ a).</S>
			<S sid ="487" ssid = "487">r EOn Sum both sides over all a E (N U T)* such that (A -+ a) E R. By the constraints (37), AA = LJ ( A;T )P( T IOn ).</S>
			<S sid ="488" ssid = "488">r EOn Therefore we prove that if there is a minimizer, it has to be Pn, where To see that there is a minimizer of Kn( q) subject to (37), consider the boundary points of the region { q = { q( A -+ a)} : q( A -+ a) &gt; 0, L q( A -+ a) = 1} a s.t.</S>
			<S sid ="489" ssid = "489">(A-&gt;a)ER Any boundary point of the region has a component equal to zero, hence for some T E On, q(T ) = 0, implying Kn( q) = oo.</S>
			<S sid ="490" ssid = "490">Because Kn( q) is a continuous function, Kn must attain its minimum inside the above region, and this minimizer, as has been shown, is Pn· We need to show Pn -+ p. Let O&apos; = On and apply Lemma 2 to p( T IOn ) and Pn( T ).</S>
			<S sid ="491" ssid = "491">Since p( Onl On) = 1, we get O ::; -log pn (On ) ::; Kn( Pn )· On the other hand, because Pnis the minimizer of Kn, Kn( Pn ) ::; Kn( P ) = -log p(On ) Because On -+ 0 and p is proper, p( On) -+ 1.</S>
			<S sid ="492" ssid = "492">Therefore O ::; -log pn (On ) ::; -log p(On ) -+ 0.</S>
			<S sid ="493" ssid = "493">Hence Pn( On) -+ 1.</S>
			<S sid ="494" ssid = "494">Choose an arbitrary T E 0.</S>
			<S sid ="495" ssid = "495">For all n large enough, T E On.</S>
			<S sid ="496" ssid = "496">Apply Lemma 2 to {T} and get p( T l On ) 1- p( Tl On ) , 0 :=; p( T IOn ) log Pn(T IOn ) + (1 - p(TI On )) log l -Pn( T IOn ) ::; Kn( Pn ) -+ 0 p( Tl On ) 1- p( Tl On) ==} p( T IOn ) log Pn(T IOn ) + (1 - p(TI On ) ) log 1Pn( T IOn ) -+ 0 ==} r p( Tl On ) - 1 n!.1.</S>
			<S sid ="497" ssid = "497">! Pn(T IOn ) - · Together with p( T IOn ) -+ p( T ) &gt; 0 and Pn( On) -+ 1, this implies lim Pn(T ) = lim Pn(T IOn ) = lim Pn( T IOn ) = p( T ).</S>
			<S sid ="498" ssid = "498">n--+ oo n--+ oo n--+ oo This nearly completes the proof.</S>
			<S sid ="499" ssid = "499">By the identifiability of production probabilities, Pn should converge to p. To make the argument more rigorous, by compactness of Pn, every subsequence of Pn has a limit point.</S>
			<S sid ="500" ssid = "500">Let p &apos; be a limit point of a subsequence Pn;· For any T, since Pn;( r) -+ p( r), p &apos;( r) = p( r).</S>
			<S sid ="501" ssid = "501">By the identifiability of production probabilities, p &apos; = p. Therefore p is the only limit point of Pn· This proves Pn -+ p.</S>
	</SECTION>
	<SECTION title="Acknowledgments">
			<S sid ="502" ssid = "502">I am indebted to Stuart Ceman and Mark Johnson for encouraging me to look at problems in this paper in the first place, and for various discussions and suggestions along the way.</S>
			<S sid ="503" ssid = "503">I am also grateful to the referees&apos; careful reading of the original manuscript.</S>
	</SECTION>
</PAPER>
